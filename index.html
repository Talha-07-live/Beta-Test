<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <script src="https://ssl.p.jwpcdn.com/player/v/8.26.8/jwplayer.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .hide { display: none; }
        .overflow3 { overflow: hidden; }
        .player-box { width: 100%; height: 500px; }
        iframe { width: 100%; height: 100%; border: none; }
        .player-msg { color: white; }
        .player-next-btn { /* Add styles for the next episode button */ }
        .jw-orientation-portrait { /* Add styles for portrait orientation */ }
    </style>
</head>
<body>
    <div class="body" data-time="your-time-data">
        <div id="player" class="hide">
            <div id="jw"></div>
        </div>
        <div class="player-box">
            <!-- Dynamic iframe will be appended here -->
        </div>
    </div>

    <script>
        function playerstart(VideoID) {
            var t = $(".body").attr("data-time");
            var gettitle = $(".model-title").text();
            $("#player").removeClass("hide");
            $(".body").addClass("overflow3");

            const playerInstance = jwplayer('jw').setup({
                playlist: "/playlist.php?id=" + VideoID + "&t=" + encodeURIComponent(gettitle) + "&tm=" + t,
                width: "100%",
                height: "100%",
                preload: "auto",
                label: "360p",
                default: true,
                hlshtml: true,
                autostart: "viewable",
                primary: 'html5',
                type: "mp4",
                androidhls: true,
                horizontalVolumeSlider: true,
                pipIcon: "disabled",
                playbackRateControls: true,
                key: "c6Wt+3BVVfc9af5UKM76pP5Vxu+Tu55CBvqMZGg3pEc=",
                skin: {
                    controlbar: {
                        background: "rgba(245, 245, 245, 0)",
                        icons: "#ffffff",
                        iconsActive: "rgb(244, 129, 129)"
                    },
                    timeslider: {
                        progress: "rgba(253, 0, 0)",
                        rail: "rgba(247, 244, 244, 0.40)",
                        buffer: "rgb(255, 255, 255)"
                    }
                }
            });

            playerInstance.on('play', function() {
                $(".player-box").append('<iframe src="https://streamtape.net/e/9exx98qM8wIaMo1/" allowfullscreen allowtransparency allow="autoplay" scrolling="no" frameborder="0"></iframe>');
            });

            playerInstance.on('error', function() {
                $(".jw-error-text.jw-reset-text").html('Video Under Progress.<span class="jw-break jw-reset"></span><span class="jw-error-text-2">Try Again After Some Time.</span>');
            });

            playerInstance.on('setupError', function() {
                $(".jw-error-text.jw-reset-text").html('Internet ERROR.<span class="jw-break jw-reset"></span><span class="jw-error-text-2"><button onclick="location.reload()" style="padding: 10px 20px;background: white;color: black;font-size: 18px;border-radius: 7px;display: flex;align-items: center;font-weight: bolder;"><img class="svg-icon" src="/img/playdark2222.svg" style="margin-right: 7px;"> Replay<div></div></button>Click the Replay button to try again.</span>');
            });

            playerInstance.on('ready', function() {
                $(".jw-title-primary").before("<span class='player-msg'>You\'re Watching</span>");
                $(".jw-title-secondary").append("<span>" + $(".model-year").text() + "</span> <span>" + $(".model-ua").text() + "</span> <span>" + $(".model-runtime").text() + "</span>");
                $(".jw-reset.jw-spacer").html('<span class="player-bottom-title">' + $(".model-title").text() + '</span>');
                $(".jw-title.jw-reset-text").append("<p class='jw-title-des'>" + $(".model-description").text() + "</p>");
            });

            playerInstance.on('time', function(e) {
                var dur = playerInstance.getDuration().toString().split('.');
                var pos = e.position.toString().split('.');
                if (pos[0] > 20) {
                    createCookie(VideoID, `${Math.floor(e.position)}:${dur[0]}`, 60);
                }
                $("#player #jw").toggleClass("jw-orientation-portrait", window.innerHeight > window.innerWidth);
            });
        }

        function createCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "") + expires + "; path=/";
        }

        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
    </script>
</body>
</html>
