<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat and Video Player</title>
    <link href="https://vjs.zencdn.net/7.14.3/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/7.14.3/video.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        #messages {
            list-style: none;
            height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
        }

        #messages li {
            padding: 5px;
            border-bottom: 1px solid #eee;
        }

        .pending {
            opacity: 0.5;
        }
    </style>
</head>
<body>

<h1>Chat Section</h1>
<ul id="messages" data-last_message_id="-1"></ul>

<form id="chatForm" action="javascript:void(0);">
    <input type="text" name="name" placeholder="Your name">
    <input type="text" name="content" id="content" placeholder="Your message">
    <button type="submit">Send</button>
</form>

<h1>Video Player Section</h1>
<video id="video" class="video-js vjs-default-skin" width="640" height="264" controls preload="auto">
    <source src="https://api005.backblazeb2.com/file/ssbucket/90182bf9-7322-11ef-82ba-d50bcd41e956.mp4" type="video/mp4">
</video>

<script>
    $(document).ready(function(){
        // Simulating chat by loading messages.json
        var poll_for_new_messages = function(){
            $.ajax({
                url: 'messages.json',
                dataType: 'json',
                ifModified: true,
                timeout: 2000,
                success: function(messages, status){
                    if (!messages) return;

                    $('ul#messages > li.pending').remove();
                    var last_message_id = $('ul#messages').data('last_message_id');
                    if (last_message_id == null) last_message_id = -1;

                    for(var i = 0; i < messages.length; i++) {
                        var msg = messages[i];
                        if (msg.id > last_message_id) {
                            var date = new Date(msg.time * 1000);
                            $('<li/>').text(msg.content)
                                .prepend($('<small />').text(date.getHours() + ':' + date.getMinutes() + ' ' + msg.name))
                                .appendTo('ul#messages');
                            $('ul#messages').data('last_message_id', msg.id);
                        }
                    }
                    $('ul#messages').scrollTop($('ul#messages').get(0).scrollHeight);
                }
            });
        };

        // Handle form submission
        $('form').submit(function(){
            var form = $(this);
            var name = form.find("input[name='name']").val();
            var content = form.find("input[name='content']").val();
            if (name == '' || content == '') return false;

            // Add new message to chat
            $('<li class="pending" />').text(content).prepend($('<small />').text(name)).appendTo('ul#messages');
            $('ul#messages').scrollTop($('ul#messages').get(0).scrollHeight);
            form.find("input[name='content']").val('').focus();
            return false;
        });

        poll_for_new_messages();
        setInterval(poll_for_new_messages, 2000);
    });

    // Initialize video player
    var player = videojs("video", {
        autoplay: false,
        muted: false,
        controls: true,
        playsinline: true,
    });

    player.on("play", function() {
        player.poster("");
    });
</script>
   (function(){
  'use strict';
  const redirect = 'https://cdn.jsdelivr.net/gh/kiprox/cf-gdplay@master/assets/img/93656b62-2a01-4649-b2f3-84e9d0dde40a.jpg';
  
  const devtools = { isOpen: false, orientation: undefined };
  const threshold = 160;

  const emitEvent = (isOpen, orientation) => {
    window.dispatchEvent(new CustomEvent('devtoolschange', { detail: { isOpen, orientation } }));
  };

  const main = () => {
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    const orientation = widthThreshold ? 'vertical' : 'horizontal';

    if ((window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) || widthThreshold || heightThreshold) {
      if (!devtools.isOpen || devtools.orientation !== orientation) {
        emitEvent(true, orientation);
      }
      devtools.isOpen = true;
      devtools.orientation = orientation;
    } else {
      if (devtools.isOpen) {
        emitEvent(false, undefined);
      }
      devtools.isOpen = false;
      devtools.orientation = undefined;
    }
  };

  main();

  setInterval(main, 500);

  window.addEventListener('devtoolschange', event => {
    if (event.detail.isOpen) {
      window.location.href = redirect;
    }
  });
})();
</body>
</html>
